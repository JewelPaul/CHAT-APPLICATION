<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChatWave - Connect Instantly</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" type="image/png" href="images/favicon.png">
    <meta name="description" content="ChatWave - Connect instantly with others using unique codes. No sign-up required!">
</head>
<body>
    <div class="app-container">
        <!-- Welcome Screen -->
        <div class="welcome-screen" id="welcome-screen">
            <div class="welcome-content">
                <div class="logo">
                    <i class="fas fa-comments"></i>
                    <h1>ChatWave</h1>
                </div>
                <p class="tagline">Connect instantly with anyone, anywhere</p>

                <div class="device-info">
                    <div class="user-avatar-container">
                        <img id="welcome-user-avatar" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMzEgMjMxIj48cGF0aCBkPSJNMzMuODMsMzMuODNhMTE1LjUsMTE1LjUsMCwxLDEsMCwxNjMuMzQsMTE1LjQ5LDExNS40OSwwLDAsMSwwLTE2My4zNFoiIHN0eWxlPSJmaWxsOiNkMWQxZDE7Ii8+PHBhdGggZD0ibTE1Ny4zLDEyOS40NWMtNi44LDMuNC0xNC44NSw1LjEtMjMuNyw1LjEtOC44NSwwLTE2LjktMS43LTIzLjctNS4xLTIzLjI1LDUuMS00My4zNSwyMC40LTQzLjM1LDQxLjY1LDAsMCwwLDQyLjUsMCw4LjUsMCwwLDEzLjYsMCwxMy42LDAsMCw0Mi41LDAsMCwwLDAsOC41LDAsMTMuNiwwLDEzLjYsMCw0Mi41LDAsMCwwLDAsODUsMCwwLDQyLjUsMCw0Mi41LDAsMCwyMS4yNS0yMC40LDQzLjM1LTQzLjM1LTQzLjM1WiIgc3R5bGU9ImZpbGw6I2ZmZjsiLz48cGF0aCBkPSJtMTMzLjYsMTI3Ljc1YzE2LjE1LDAsMjkuNzUtMTMuNiwyOS43NS0zOC4yNSwwLTE1LjMtMTMuNi0yOS43NS0yOS43NS0yOS43NXMtMjkuNzUsMTQuNDUtMjkuNzUsMjkuNzVjMCwyNC42NSwxMy42LDM4LjI1LDI5Ljc1LDM4LjI1WiIgc3R5bGU9ImZpbGw6I2ZmZjsiLz48L3N2Zz4=" alt="Your Avatar">
                        <div class="avatar-upload">
                            <label for="avatar-upload-input" class="avatar-upload-label">
                                <i class="fas fa-camera"></i>
                            </label>
                            <input type="file" id="avatar-upload-input" accept="image/*" class="hidden">
                        </div>
                    </div>
                    <p>Your device: <span id="device-name">Loading...</span></p>
                    <div class="unique-code-container">
                        <p>Your unique code:</p>
                        <div class="code-display">
                            <span id="unique-code">Loading...</span>
                            <button id="copy-code-btn" title="Copy to clipboard">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <p class="code-hint">Share this code with others to chat</p>
                    </div>
                </div>

                <div class="connect-form">
                    <h2>Connect with someone</h2>
                    <div class="input-group">
                        <input type="text" id="connect-code" placeholder="Enter their unique code">
                        <button id="connect-btn" class="btn btn-primary">
                            <i class="fas fa-plug"></i> Connect
                        </button>
                    </div>
                </div>

                <div class="features">
                    <div class="feature">
                        <i class="fas fa-lock"></i>
                        <p>End-to-end encrypted</p>
                    </div>
                    <div class="feature">
                        <i class="fas fa-user-secret"></i>
                        <p>No sign-up required</p>
                    </div>
                    <div class="feature">
                        <i class="fas fa-history"></i>
                        <p>No chat history stored</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chat Interface -->
        <div class="chat-interface hidden" id="chat-interface">
            <div class="chat-sidebar">
                <div class="sidebar-header">
                    <div class="logo">
                        <i class="fas fa-comments"></i>
                        <h1>ChatWave</h1>
                    </div>
                    <button id="mobile-menu-toggle" class="mobile-menu-toggle">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>

                <div class="user-profile">
                    <div class="user-avatar">
                        <img id="user-avatar" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMzEgMjMxIj48cGF0aCBkPSJNMzMuODMsMzMuODNhMTE1LjUsMTE1LjUsMCwxLDEsMCwxNjMuMzQsMTE1LjQ5LDExNS40OSwwLDAsMSwwLTE2My4zNFoiIHN0eWxlPSJmaWxsOiNkMWQxZDE7Ii8+PHBhdGggZD0ibTE1Ny4zLDEyOS40NWMtNi44LDMuNC0xNC44NSw1LjEtMjMuNyw1LjEtOC44NSwwLTE2LjktMS43LTIzLjctNS4xLTIzLjI1LDUuMS00My4zNSwyMC40LTQzLjM1LDQxLjY1LDAsMCwwLDQyLjUsMCw4LjUsMCwwLDEzLjYsMCwxMy42LDAsMCw0Mi41LDAsMCwwLDAsOC41LDAsMTMuNiwwLDEzLjYsMCw0Mi41LDAsMCwwLDAsODUsMCwwLDQyLjUsMCw0Mi41LDAsMCwyMS4yNS0yMC40LDQzLjM1LTQzLjM1LTQzLjM1WiIgc3R5bGU9ImZpbGw6I2ZmZjsiLz48cGF0aCBkPSJtMTMzLjYsMTI3Ljc1YzE2LjE1LDAsMjkuNzUtMTMuNiwyOS43NS0zOC4yNSwwLTE1LjMtMTMuNi0yOS43NS0yOS43NS0yOS43NXMtMjkuNzUsMTQuNDUtMjkuNzUsMjkuNzVjMCwyNC42NSwxMy42LDM4LjI1LDI5Ljc1LDM4LjI1WiIgc3R5bGU9ImZpbGw6I2ZmZjsiLz48L3N2Zz4=" alt="Your Avatar">
                        <span class="status-indicator online"></span>
                    </div>
                    <div class="user-info">
                        <h3 id="user-name">Your Device</h3>
                        <p id="user-status">Online</p>
                    </div>
                </div>

                <div class="unique-code-display">
                    <p>Your unique code: <span id="sidebar-unique-code">Loading...</span></p>
                    <button id="sidebar-copy-code-btn" title="Copy to clipboard">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>

                <div class="connections-list" id="connections-list">
                    <h2>Active Connections</h2>
                    <div class="empty-connections-message" id="empty-connections-message">
                        <i class="fas fa-plug"></i>
                        <p>No active connections</p>
                        <p>Connect with someone to start chatting</p>
                    </div>
                    <ul id="connections"></ul>
                </div>

                <div class="sidebar-actions">
                    <button id="new-connection-btn" class="btn btn-primary">
                        <i class="fas fa-plus"></i> New Connection
                    </button>
                    <button id="disconnect-all-btn" class="btn btn-danger">
                        <i class="fas fa-unlink"></i> Disconnect All
                    </button>
                </div>
            </div>

            <div class="chat-main">
                <div class="chat-header">
                    <button id="back-button" class="back-button">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <div class="chat-user-info">
                        <div class="user-avatar">
                            <img id="chat-user-avatar" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMzEgMjMxIj48cGF0aCBkPSJNMzMuODMsMzMuODNhMTE1LjUsMTE1LjUsMCwxLDEsMCwxNjMuMzQsMTE1LjQ5LDExNS40OSwwLDAsMSwwLTE2My4zNFoiIHN0eWxlPSJmaWxsOiNkMWQxZDE7Ii8+PHBhdGggZD0ibTE1Ny4zLDEyOS40NWMtNi44LDMuNC0xNC44NSw1LjEtMjMuNyw1LjEtOC44NSwwLTE2LjktMS43LTIzLjctNS4xLTIzLjI1LDUuMS00My4zNSwyMC40LTQzLjM1LDQxLjY1LDAsMCwwLDQyLjUsMCw4LjUsMCwwLDEzLjYsMCwxMy42LDAsMCw0Mi41LDAsMCwwLDAsOC41LDAsMTMuNiwwLDEzLjYsMCw0Mi41LDAsMCwwLDAsODUsMCwwLDQyLjUsMCw0Mi41LDAsMCwyMS4yNS0yMC40LDQzLjM1LTQzLjM1LTQzLjM1WiIgc3R5bGU9ImZpbGw6I2ZmZjsiLz48cGF0aCBkPSJtMTMzLjYsMTI3Ljc1YzE2LjE1LDAsMjkuNzUtMTMuNiwyOS43NS0zOC4yNSwwLTE1LjMtMTMuNi0yOS43NS0yOS43NS0yOS43NXMtMjkuNzUsMTQuNDUtMjkuNzUsMjkuNzVjMCwyNC42NSwxMy42LDM4LjI1LDI5Ljc1LDM4LjI1WiIgc3R5bGU9ImZpbGw6I2ZmZjsiLz48L3N2Zz4=" alt="Contact">
                            <span class="status-indicator online"></span>
                        </div>
                        <div class="user-details">
                            <h3 id="chat-user-name">Contact</h3>
                            <p id="chat-user-status">Online</p>
                        </div>
                    </div>
                    <div class="chat-actions">
                        <button id="info-button" class="action-button" title="Connection Info">
                            <i class="fas fa-info-circle"></i>
                        </button>
                        <button id="disconnect-button" class="action-button" title="Disconnect">
                            <i class="fas fa-unlink"></i>
                        </button>
                    </div>
                </div>

                <div class="messages-container" id="messages-container">
                    <div class="empty-chat-message" id="empty-chat-message">
                        <i class="fas fa-comment-alt"></i>
                        <p>No messages yet</p>
                        <p>Start the conversation by sending a message</p>
                    </div>
                </div>

                <div class="typing-indicator hidden" id="typing-indicator">
                    <div class="typing-dots">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </div>

                <div class="message-input-container">
                    <input type="file" id="file-input" style="display: none;" accept="image/*,video/*,audio/*,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-powerpoint,application/vnd.openxmlformats-officedocument.presentationml.presentation,application/zip,application/x-zip-compressed,text/plain">
                    <button class="attachment-button" id="attachment-button" title="Attach a file">
                        <i class="fas fa-paperclip"></i>
                    </button>
                    <div class="message-input">
                        <input type="text" id="message-input" placeholder="Type a message...">
                        <div class="input-actions">
                            <button class="emoji-button" id="emoji-button" title="Insert emoji">
                                <i class="far fa-smile"></i>
                            </button>
                        </div>
                    </div>
                    <button class="send-button" id="send-button" title="Send message">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>

            <div class="info-panel" id="info-panel">
                <div class="info-header">
                    <h2>Connection Info</h2>
                    <button class="close-info-panel" id="close-info-panel">
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <div class="connection-details">
                    <div class="user-profile-large">
                        <div class="user-avatar-large">
                            <img id="info-user-avatar" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMzEgMjMxIj48cGF0aCBkPSJNMzMuODMsMzMuODNhMTE1LjUsMTE1LjUsMCwxLDEsMCwxNjMuMzQsMTE1LjQ5LDExNS40OSwwLDAsMSwwLTE2My4zNFoiIHN0eWxlPSJmaWxsOiNkMWQxZDE7Ii8+PHBhdGggZD0ibTE1Ny4zLDEyOS40NWMtNi44LDMuNC0xNC44NSw1LjEtMjMuNyw1LjEtOC44NSwwLTE2LjktMS43LTIzLjctNS4xLTIzLjI1LDUuMS00My4zNSwyMC40LTQzLjM1LDQxLjY1LDAsMCwwLDQyLjUsMCw4LjUsMCwwLDEzLjYsMCwxMy42LDAsMCw0Mi41LDAsMCwwLDAsOC41LDAsMTMuNiwwLDEzLjYsMCw0Mi41LDAsMCwwLDAsODUsMCwwLDQyLjUsMCw0Mi41LDAsMCwyMS4yNS0yMC40LDQzLjM1LTQzLjM1LTQzLjM1WiIgc3R5bGU9ImZpbGw6I2ZmZjsiLz48cGF0aCBkPSJtMTMzLjYsMTI3Ljc1YzE2LjE1LDAsMjkuNzUtMTMuNiwyOS43NS0zOC4yNSwwLTE1LjMtMTMuNi0yOS43NS0yOS43NS0yOS43NXMtMjkuNzUsMTQuNDUtMjkuNzUsMjkuNzVjMCwyNC42NSwxMy42LDM4LjI1LDI5Ljc1LDM4LjI1WiIgc3R5bGU9ImZpbGw6I2ZmZjsiLz48L3N2Zz4=" alt="Contact">
                        </div>
                        <h3 id="info-user-name">Contact</h3>
                        <p id="info-user-device">Device</p>
                    </div>

                    <div class="info-section">
                        <h4>Connection Details</h4>
                        <ul class="details-list">
                            <li>
                                <span class="detail-label">Status:</span>
                                <span class="detail-value" id="info-connection-status">Connected</span>
                            </li>
                            <li>
                                <span class="detail-label">Connected since:</span>
                                <span class="detail-value" id="info-connection-time">Just now</span>
                            </li>
                            <li>
                                <span class="detail-label">Unique code:</span>
                                <span class="detail-value" id="info-unique-code">ABC123</span>
                            </li>
                        </ul>
                    </div>

                    <div class="info-section">
                        <h4>Security</h4>
                        <p class="security-info">
                            <i class="fas fa-lock"></i> This connection is end-to-end encrypted. Messages are only visible to you and your contact.
                        </p>
                    </div>

                    <div class="info-actions">
                        <button id="info-disconnect-btn" class="btn btn-danger">
                            <i class="fas fa-unlink"></i> Disconnect
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notifications -->
        <div class="notifications-container" id="notifications-container"></div>

        <!-- Connection Status -->
        <div class="connection-status" id="connection-status">
            <div class="connecting hidden" id="connecting-status">
                <i class="fas fa-spinner fa-spin"></i>
                <span>Connecting to <span id="connecting-code"></span>...</span>
            </div>
            <div class="connection-error hidden" id="connection-error">
                <i class="fas fa-exclamation-circle"></i>
                <span id="error-message">Connection error</span>
            </div>
        </div>

        <!-- Footer Button -->
        <div class="footer-button" id="footer-button">
            <i class="fas fa-info-circle"></i>
        </div>

        <!-- Footer Modal -->
        <div class="modal" id="footer-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>ChatWave</h2>
                    <button class="close-modal" id="close-footer-modal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <p>ChatWave is a student project designed to provide a simple, secure, and easy-to-use chat application.</p>
                    <div class="footer-links-container">
                        <a href="about.html" target="_blank" class="footer-link">
                            <i class="fas fa-info-circle"></i> About
                        </a>
                        <a href="terms.html" target="_blank" class="footer-link">
                            <i class="fas fa-file-contract"></i> Terms
                        </a>
                        <a href="privacy.html" target="_blank" class="footer-link">
                            <i class="fas fa-shield-alt"></i> Privacy
                        </a>
                        <a href="contact.html" target="_blank" class="footer-link">
                            <i class="fas fa-envelope"></i> Contact
                        </a>
                    </div>
                    <p class="footer-copyright">&copy; 2025 ChatWave. All rights reserved. This is a student project.</p>
                </div>
            </div>
        </div>

        <!-- Connection Modal -->
        <div class="modal" id="connection-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Connect with someone</h2>
                    <button class="close-modal" id="close-connection-modal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <p>Enter the unique code of the person you want to connect with:</p>
                    <div class="input-group">
                        <input type="text" id="modal-connect-code" placeholder="Enter unique code (e.g., ABC123)">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" id="cancel-connection-btn">Cancel</button>
                    <button class="btn btn-primary" id="confirm-connection-btn">Connect</button>
                </div>
            </div>
        </div>

        <!-- Connection Request Modal -->
        <div class="modal" id="connection-request-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Connection Request</h2>
                </div>
                <div class="modal-body">
                    <div class="connection-request-info">
                        <i class="fas fa-user-plus connection-request-icon"></i>
                        <p>Someone wants to connect with you:</p>
                        <div class="request-details">
                            <p>Unique code: <span id="request-from-code">ABC123</span></p>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" id="reject-connection-btn">Reject</button>
                    <button class="btn btn-primary" id="accept-connection-btn">Accept</button>
                </div>
            </div>
        </div>

        <!-- Connection Waiting Modal -->
        <div class="modal" id="connection-waiting-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Waiting for Response</h2>
                    <button class="close-modal" id="close-waiting-modal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="connection-waiting-info">
                        <i class="fas fa-spinner fa-spin connection-waiting-icon"></i>
                        <p>Waiting for <span id="waiting-for-code">ABC123</span> to accept your connection request...</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" id="cancel-waiting-btn">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/uuid/8.3.2/uuid.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.6.1/socket.io.min.js"></script>
    <script src="js/direct-fix.js"></script>
    <script src="js/socket-connection.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
